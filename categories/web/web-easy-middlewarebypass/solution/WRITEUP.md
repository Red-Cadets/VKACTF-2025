## Коллектив 1.0 

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKACTF 2025 | Коллектив 1.0 | Web | easy |

  
### Описание


> Автор: [seraphic_grin](https://t.me/seraphic_grin)
>
Тут что-то сервис с роботами шалит, а админ ушел в отпуск. Разберись!


### Решение
Игроку дан сервис для роботов, где они могут смотреть приказы. Роботы при регистрации выбирают модель, но нельзя выбрать определенную модель. Из исходников видно, что есть админ-панель, в которой он видит роботов, может добавлять модели и издавать приказы для этих моделей. На вкладке модели боевые роботы помечены красным и подписаны. Приказы для боевых моделей не высвечиваются в админ панели, а доступны только роботам этой боевой модели. В личном кабинете робота также нельзя поменять свою модель на боевую. Кроме того учетная запись администратора не создается при инициализации, то есть забрутить креды не получится. Нас интересует именно панель администрирования экосистемой Коллектив 1.0, так как там есть вкладка "Загрузить дамп". Необходимо добавить робота от админа с запретной моделью и затем авторизоваться как зареганный робот.

Смотрим файл middleware.ts, там прописан редирект на страницу входа в админ-панель в случае отсутствия токена админа(которого у нас быть не может, так как его в БД нет). Смотрим версию ПО и видим  "next": "15.2.1", а это значит [CVE-2025-29927](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC) -> добавляем необходимый заголовок и попадаем в админ-панель. Смотрим на странице моделей какой id у боевой модели, запоминаем. Загружаем dump.sql с командой ` INSERT INTO "Robot" (name, "modelId", password)  VALUES ('Vuln', *id_боевой_модели*, '$2a$10$/HSu52ZCs1A/H1TyYXOKWu8A6ufl8AsnqMfXW7Yt6nQ8FHT05UOFu'); `. В исходниках видно, что пароль хранится в виде хеша, переменная `const saltOrRounds = 10`, соответственно хешируем где угодно bcrypt'ом с солью 10 и регаем боевого робота. Затем авторизуемся и переходим на страницу приказов. Видим флаг

### Флаг

```
vkactf{kakoi_nah_middleware_na_fronte_ty_v_svoem_ume}
```
