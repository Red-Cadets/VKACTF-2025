##Кастомный Коблиц

| Событие | Название | Категория | Сложность |
| :------------- | ----------------------- | ------------------ | ------------------ |
| VKACTF 2025   | Шифр дельфина     | crypto             | medium               |

### Описание

> Автор: Inssurg3nt

На Лазурном дне обитают самые умные и креативные дельфины



# Решение

Смотрим в исходники и понимаем, что имеем дело с самописным шифром, который работает на эллиптических кривых, дейсвия с которыми описаны в модуле ECC_crypto.py. 

```python

def encrypt(self, msg: list, k: list):
    ciphertext = self.Koblitz.encrypt(msg, k)

    return ciphertext

```

Вникаем в алгоритм некого Коблица и понимаем, что кривая устойчива к стандартным атакам, так как соответствует стандарту secp256k1.

Дальнейший анализ кода позволяет заметить, что допущена ошибка конфигурации и размер блока равен единице.

```python

def __init__(self):

    bits_length = 64
    self.block_size = 1
    curve_instance = SafeEllipticCurve(bits_length, secp256k1=False)
    self.Koblitz = KoblitzCurve(curve_instance)

```

Это позволяет нам сделать вывод о том, что в данном случае применима атака посредством частотного криптоанализа, так как к каждой закодированной в точку букве прибавляется одна и та же точка. То есть одна и та же буква будет иметь одну и ту же точку в шифротексте.

С сайта википедии берем [частоту встречающихся букв](https://ru.wikipedia.org/wiki/Частотность), записываем их в порядке убывания частоты в массив и, подсчитав частоту каждой точки в шифротексте, заменяем на буквы.

*Для более точного криптоанализа следует брать как можно больше шифротекста.

Решение представлено на языке [Python3](./solve.py).


### Флаг

```
vka{Sergeevich}
