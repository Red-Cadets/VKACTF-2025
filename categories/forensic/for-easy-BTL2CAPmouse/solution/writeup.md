## Решил, нарисовал, победил

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKACTF 2025 | Решил&Нарисовал | forensic | easy |

  
### Описание


> Автор: one!tea
>
Кажется, что товарищ Петров создал себе хранилище прямо в обучающем приложении для школьников. Нам удалось получить его трафик, когда он работал с ним, погляди...


### Решение
Сначала зайдём на данный сайт и исследуем его функционал. Нам предлагают 15 примеров, ответы на которые мы рисуем в специальном окне. Посмотрев внимательно трафик с сайтом через `BurpSuite` или `Инструменты разработчика браузера`, понимаем, что на сервер отправляются фото наших рисунков. Получается, чтобы не рисовать вручную, мы можем собрать базу уже готовых цифр в base64, которые сервер верно определяет всегда.

Однако даже если мы решим все, мы не получим ничего, а игра обнулится...

Ну что ж, перейдём к исследованию трафика в `WireShark`.

Тут прилично пакетов одного формата. Изучив их, понимаем, что это bluetooth-трафик и, поскольку раз сайт имеет только функционал рисования, предполагаем, что это трафик какого-то устройства ввода.

Действительно, погуглив про `BTL2CAP` пакеты, мы утверждаемся в нашем предположении.

Теперь нам осталось получить какую-то полезную информацию из каждого пакета. Value - то, что всегда изменяется в каждом пакете и выглядит интересно.  [Google, помоги!](https://novelbits.io/bluetooth-hid-device-design-example-project/)

```
typedef struct
{
    uint8_t         buttons_bitmask;
    uint8_t         move_x_lsb;
    uint8_t         move_x_msb;
    uint8_t         move_y_lsb;
    uint8_t         move_y_msb;
    uint8_t         scroll_v;
} __packed simplemouse_hids_report_mouse_t;
```

Вот такая получается структура Value после недолгих поисков. Пишем [сплойт для получения того, что рисовал Петров](combRecv.py).

Ура! 15 цифр в нужном порядке у нас на руках. Вручную цифры рисовать можно, но очень долго и сложно... Пишем [сплойт](flagRecv.py), отправляя base64 заготовленные картинки.

Запускаем... Вуаля, флаг!

### Флаг

```
vka{admin_bluetooth_mouse_draw_smth_cool}
```
